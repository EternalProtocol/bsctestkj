import{H as C,r as n,i as B,j as e,B as w,F as S,p as j,X as v,D as k,Y as I}from"./vendor-B9IB914J.js";import{a as E}from"./arrow-Dt4f_FJz.js";import{A as m,N as h}from"./index-YG593oy5.js";import{P as H}from"./index-Be7kqAQ1.js";import{u as A}from"./useSequentialContractWrite-swUE3PVz.js";import{M as z}from"./MiningMachineProductionLogic-CseX3utK.js";import"./helper-Cniy7oTW.js";import"../assets/index-D0p5yCsU.js";import"./MiningMachineSystemLogic-BW-YOQBb.js";const F="/assets/claim-mix-bg-Bofu7TNW.svg",X="data:image/svg+xml,%3csvg%20viewBox='0%200%2037%2037'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='37'%20height='37'%20fill='none'%20customFrame='%23000000'%3e%3cg%20id='组合%203435'%3e%3cg%20id='组合%20253'%3e%3crect%20id='矩形备份%2069'%20width='37'%20height='37'%20x='0'%20y='0'%20rx='13'%20fill='rgb(246,244,252)'%20/%3e%3crect%20id='矩形备份%2069'%20width='36'%20height='36'%20x='0.5'%20y='0.5'%20rx='13'%20stroke='rgb(151,151,151)'%20stroke-opacity='0'%20stroke-width='1'%20/%3e%3ccircle%20id='椭圆%2028'%20cx='18.5'%20cy='18.5'%20r='10.5'%20fill='rgb(0,0,0)'%20/%3e%3c/g%3e%3cg%20id='组合%203431'%3e%3cpath%20id='矢量%20173'%20d='M21.0347%2016.9569C21.0347%2016.9569%2023.7886%2015.6291%2023.8378%2015.4816C23.887%2015.334%2024.2311%2015.4816%2024.2311%2015.4816L24.2311%2023.7927L16.8545%2023.7927C16.8545%2023.7927%2020.6411%2020.8912%2021.0347%2016.9569Z'%20fill='rgb(255,255,255)'%20fill-rule='nonzero'%20/%3e%3cpath%20id='矢量%20174'%20d='M18.0344%2019.465L18.6492%2019.0225L19.018%2019.2437L19.1165%2019.2437L19.1165%2020.4486L18.7968%2020.5961L18.0344%2019.465ZM16.4854%2020.5961L16.8543%2020.3504L17.1493%2020.1535L17.764%2020.1535L17.8625%2020.5961L18.0344%2020.7929L18.0344%2021.4567L17.2599%2021.8748L16.6329%2022.0222L16.4854%2022.0222L16.4854%2020.5961Z'%20fill='rgb(255,255,255)'%20fill-rule='nonzero'%20/%3e%3cpath%20id='矢量%20175'%20d='M14.0511%2021.6777L18.3788%2017.1534L19.9034%2019.1453L20.395%2017.7928L19.4608%2016.588L19.1166%2016.465L19.3623%2016.0962L19.387%2015.9487L19.2641%2015.8258C19.2641%2015.8258%2018.9383%2015.4323%2018.5694%2015.4753L18.4957%2015.5737L18.4527%2015.5983L18.3235%2015.5184C18.3235%2015.5184%2016.9588%2014.0615%2014.8626%2014L14.8379%2014.1599L17.5551%2016.2745L13%2020.7557L13%2021.2169L13.4425%2021.6778L14.0511%2021.6777Z'%20fill='rgb(255,255,255)'%20fill-rule='nonzero'%20/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",R=a=>I.unix(a).format("MM月 DD日 HH:mm:ss"),J=()=>{const a=C(),{machineList:d,mixPointsToBeClaimed:l}=a.state,{executeSequentialCalls:c}=A(),[g,r]=n.useState(!1),u=B(),[p,b]=n.useState(0),f=n.useRef(null),o=d.filter(t=>t.unclaimedMix>0),N=()=>{v.clear(),u("/user")},M=async()=>{try{if(r(!0),o.length===0){r(!1);return}const t=o.map(i=>i.id),L={address:H,abi:z,functionName:"claimMixByMachineIds",args:[t]},[s]=await c([L]);if(r(!1),s!=null&&s.success){let i;try{if(s.data!=null){const x=BigInt(s.data.toString());i=Number(j(x))}else i=l}catch(x){console.warn("解析合约返回值失败，使用备选值:",x),i=l}v.show({bodyStyle:{background:"#000000",color:"#ffffff",width:"75vw",padding:"15px",borderRadius:"20px"},showCloseButton:!0,closeOnMaskClick:!0,content:e.jsxs("div",{className:"pt-[15px] text-white text-[15px] flex flex-col gap-4",children:[e.jsx("div",{className:"text-[#B195FF]",children:"提示"}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:["你已成功提取所有MIX收益：",e.jsx(m,{type:h.BALANCE,value:i,decimalSubLen:2,className:"font-bold text-[15px]"}),"，已存入你的钱包中。"]}),e.jsx("button",{className:"w-full bg-[#895EFF] rounded-3xl text-white py-2",onClick:N,children:"确认"})]})]})})}}catch(t){console.error("领取MIX失败:",t),r(!1)}},y=()=>{u("/user")};return n.useEffect(()=>{if(!f.current)return;const t=()=>{const i=window.innerHeight-270;b(i)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),e.jsxs("div",{className:"px-[21px]",children:[e.jsxs("div",{className:"flex pt-4 mb-4",children:[e.jsx(w,{onClick:y,className:"!p-[0] !rounded-2xl",loading:g,children:e.jsx("img",{src:E,alt:""})}),e.jsx("span",{className:"m-auto text-[19px] font-bold",children:"收益"})]}),e.jsx("div",{className:"bg-black rounded-2xl ",children:e.jsxs("div",{style:{backgroundImage:`url(${F})`,width:"100%",height:"170px",backgroundSize:"cover",padding:"0 20px",gap:"5px",borderRadius:"1rem"},children:[e.jsxs("div",{className:"flex   text-white items-center pt-[18%]",children:[e.jsx(m,{type:h.BALANCE,value:l,decimalSubLen:2,className:"ml-2 mr-1.5  font-bold text-[26px]"}),e.jsx("div",{className:"text-[11px] pt-[8px] ",children:"MIX"})]}),e.jsx(w,{disabled:g,onClick:M,className:"w-full !bg-[#7334FE] !rounded-2xl !py-2 !my-3  !items-center  !p-0 !text-white !border-none !text-[15px]",children:"提取到钱包"})]})}),e.jsx("div",{ref:f,style:{height:`${p}px`},className:"no-scrollbar bg-white rounded-2xl p-[15px] mt-4",children:e.jsx(S,{height:p,width:"100%",itemCount:o.length,itemSize:70,itemData:o,children:D})})]})},D=n.memo(({index:a,style:d,data:l})=>{const c=l[a];return e.jsxs("div",{style:{...d,height:"70px"},children:[e.jsxs("div",{className:"flex text-[12px] items-center gap-2",children:[e.jsx("img",{src:X,alt:"",width:37,height:37}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between",children:["矿机产出",e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-[16px]",children:"+"}),e.jsx(m,{type:h.BALANCE,value:+j(BigInt(c.unclaimedMix)),decimalSubLen:4,className:"ml-2 mr-1.5  font-bold "})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-[#7E7878]",children:R(c.createTime)}),e.jsx("div",{children:"MIX积分"})]})]})]}),e.jsx(k,{style:{width:"87%",marginLeft:"auto",marginBottom:"0"}}),e.jsx("div",{className:"w-full flex justify-end"})]})});export{J as default};
