import{i as R,H as z,r as a,l as b,j as e,B as w,T as F,D as p,F as P,p as U,q as x,s as V,v as X,J as q}from"./vendor-B9IB914J.js";import{a as J}from"./arrow-Dt4f_FJz.js";import{v as O}from"./validateAddress-BE2p6uyu.js";import{c as d}from"../assets/index-Crcy1d53.js";import{S as Z,L as y,C as _}from"./index-DPA4qk5L.js";import{A,N as S}from"./index-YG593oy5.js";import{M as $}from"./MiningMachineSystemStorage-DvDQZY6X.js";import{M as C}from"./MiningMachineSystemLogic-BW-YOQBb.js";import"./helper-Cniy7oTW.js";const G=n=>n===1?"母矿机":"子矿机",K=n=>{var c;const l=n+"",t=q.SHA256(l).toString(),i=((c=t.match(/[a-zA-Z]/g))==null?void 0:c.slice(0,4).join(""))||"ABCD",h=t.slice(10,14);return(i+h).toUpperCase()},ce=()=>{const n=R(),t=z().state,[i,h]=a.useState(""),[c,u]=a.useState(!1),M=()=>{n("/sale-person")},[f,L]=a.useState(0),g=a.useRef(null),[j,H]=a.useState(0),[v,I]=a.useState(0);a.useEffect(()=>{if(!g.current)return;const s=()=>{const o=window.innerHeight-450;L(o)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const E=async()=>{var r,m;if(!((m=(r=O)==null?void 0:r.EVM)==null?void 0:m.call(r,i))){x.show({content:"请输入合法的BNB地址",position:"center",duration:2e3});return}try{const o=t.map(B=>B.id);x.show({content:"转出中...",position:"center",duration:0}),u(!0);const k=await V(d,{address:y,abi:C,functionName:"createInternalMachineOrder",args:[i,o]});await X(d,{hash:k,chainId:_}),x.clear(),n("/sale-person")}catch(o){console.error(o)}finally{u(!1)}},D=s=>{h(s)},T=async()=>{try{const s=await b(d,{address:y,abi:C,functionName:"getIDXAmount",args:[1]}),r=U(s);H(+r)}catch(s){console.error(s)}};a.useEffect(()=>{T()},[]);const N=a.useCallback(async()=>{try{const s=t[0].id,r=await b(d,{address:Z,abi:$,functionName:"motherMachinePrices",args:[s]});I(Number(r))}catch(s){console.error(s)}},[t]);return a.useEffect(()=>{N()},[N]),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"h-full overflow-hidden px-[21px] text-[16px] relative",children:[e.jsxs("div",{className:"flex",children:[e.jsx(w,{onClick:M,className:"!p-[0] !rounded-2xl",loading:c,children:e.jsx("img",{src:J,alt:""})}),e.jsx("span",{className:"m-auto text-[17px] font-bold text-black",children:"转让矿机"})]}),e.jsxs("div",{className:"transfer-container mt-2",children:[e.jsx("div",{className:"text-[16px] font-bold mb-2 text-black",children:"接收方钱包地址"}),e.jsx(F,{value:i,rows:2,className:"bg-[#ececee] rounded-3xl p-3",placeholder:"输入对方的钱包地址",onChange:D})]}),e.jsxs("div",{className:"transfer-container mt-2",children:[e.jsx("div",{className:"text-[16px] font-bold mb-2 text-black",children:"待转让详情"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:["单价：",e.jsx("span",{className:"font-bold text-black mr-1",children:e.jsx(A,{type:S.BALANCE,value:v*j,decimalSubLen:2,className:"font-bold"})}),"IDX/台"]}),e.jsxs("div",{className:"",children:["共计：",e.jsx("span",{className:"mr-2 text-[18px] font-bold text-black",children:t.length}),"台"]})]}),e.jsx(p,{className:"!mt-[10px] !mb-[0]"}),e.jsxs("div",{className:"flex justify-between py-2 text-[#777777]",children:[e.jsx("div",{children:"#"}),e.jsx("div",{children:"矿机编号"}),e.jsx("div",{children:"矿机类型"})]}),e.jsx(p,{className:"!mt-[10px] !mb-[0]"}),e.jsx("div",{ref:g,style:{height:`${f}px`},className:"no-scrollbar",children:e.jsx(P,{height:f,width:"100%",itemCount:t.length,itemSize:50,itemData:t,children:Q})})]})]}),e.jsxs("div",{className:"w-full bg-white h-[4rem] flex items-center absolute bottom-0 px-[1.875rem]",children:[e.jsxs("div",{children:[e.jsx("div",{children:"买家待支付 IDX"}),e.jsx("div",{className:"text-[#FF6D6D] text-[22px]",children:e.jsx(A,{type:S.BALANCE,value:v*t.length*j,decimalSubLen:2,className:"font-bold"})})]}),e.jsx(w,{className:"!bg-black !text-white !rounded-3xl !ml-auto   !py-2 !w-[100px]",style:{fontSize:"14px"},loading:c,onClick:E,children:"转出矿机"})]})]})},Q=({index:n,style:l,data:t})=>{const i=t[n];return e.jsxs("div",{style:{...l,height:"50px"},children:[e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("div",{children:n+1}),e.jsxs("div",{children:["#",K(i.id)]}),e.jsx("div",{children:G(i.mtype)})]}),e.jsx(p,{className:"!my-[0]"})]})};export{ce as default};
